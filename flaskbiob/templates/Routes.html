{% extends "BASE.html" %}
{% block content %}
    <div class="row">
        <div class="col-md-12">
            <button class="btn btn-primary btn-sm m-2" type="button" data-toggle="collapse" data-target="#collapsefilters" aria-expanded="false" aria-controls="collapsefilters">
                Filters
            </button>
            {% if filtered %}
                <a href="{{ url_for('routes.routesPage') }}" class="btn btn-dark btn-sm active" role="button" aria-pressed="true">Clear Search</a>
            {% endif %}
            <div id="collapsefilters" class="panel-collapse collapse">
            <form method="POST" action="" enctype="multipart/form-data">
            {{form.hidden_tag() }}
            <fieldset class="form-group">
                <legend class="border-bottom mb-4">
                    Sort and Filter
                </legend>
                <div class="row">
                    <div class="col-md-3">
                        <div class="form-group">
                            {{ form.region.label(class="form-control-label") }}

                            {% if form.region.errors %}
                                {{ form.region(class="form-control form-control-sm is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for error in form.region.errors %}
                                        <span>{{ error }}</span>
                                    {% endfor %}
                                </div>
                            {% else %}
                                {{ form.region(class="form-control form-control-sm") }}
                            {% endif %}
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            {{ form.length_min.label(class="form-control-label") }}

                            {% if form.length_min.errors %}
                                {{ form.length_min(class="form-control form-control-sm is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for error in form.length_min.errors %}
                                        <span>{{ error }}</span>
                                    {% endfor %}
                                </div>
                            {% else %}
                                {{ form.length_min(class="form-control form-control-sm") }}
                            {% endif %}
                        </div>
                        <div class="form-group">
                            {{ form.length_max.label(class="form-control-label") }}

                            {% if form.length_max.errors %}
                                {{ form.length_max(class="form-control form-control-sm is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for error in form.length_max.errors %}
                                        <span>{{ error }}</span>
                                    {% endfor %}
                                </div>
                            {% else %}
                                {{ form.length_max(class="form-control form-control-sm") }}
                            {% endif %}
                        </div>
                        <div class="form-group">
                            {{ form.ascent_min.label(class="form-control-label") }}

                            {% if form.ascent_min.errors %}
                                {{ form.ascent_min(class="form-control form-control-sm is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for error in form.ascent_min.errors %}
                                        <span>{{ error }}</span>
                                    {% endfor %}
                                </div>
                            {% else %}
                                {{ form.ascent_min(class="form-control form-control-sm") }}
                            {% endif %}
                        </div>
                        <div class="form-group">
                            {{ form.ascent_max.label(class="form-control-label") }}

                            {% if form.ascent_max.errors %}
                                {{ form.ascent_max(class="form-control form-control-sm is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for error in form.ascent_max.errors %}
                                        <span>{{ error }}</span>
                                    {% endfor %}
                                </div>
                            {% else %}
                                {{ form.ascent_max(class="form-control form-control-sm") }}
                            {% endif %}
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            {{ form.scenery_min.label(class="form-control-label") }}

                            {% if form.scenery_min.errors %}
                                {{ form.scenery_min(class="form-control form-control-sm is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for error in form.scenery_min.errors %}
                                        <span>{{ error }}</span>
                                    {% endfor %}
                                </div>
                            {% else %}
                                {{ form.scenery_min(class="form-control form-control-sm") }}
                            {% endif %}
                        </div>
                        <div class="form-group">
                            {{ form.scenery_max.label(class="form-control-label") }}

                            {% if form.scenery_max.errors %}
                                {{ form.scenery_max(class="form-control form-control-sm is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for error in form.scenery_max.errors %}
                                        <span>{{ error }}</span>
                                    {% endfor %}
                                </div>
                            {% else %}
                                {{ form.scenery_max(class="form-control form-control-sm") }}
                            {% endif %}
                        </div>
                        <div class="form-group">
                            {{ form.brutality_min.label(class="form-control-label") }}

                            {% if form.brutality_min.errors %}
                                {{ form.brutality_min(class="form-control form-control-sm is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for error in form.brutality_min.errors %}
                                        <span>{{ error }}</span>
                                    {% endfor %}
                                </div>
                            {% else %}
                                {{ form.brutality_min(class="form-control form-control-sm") }}
                            {% endif %}
                        </div>
                        <div class="form-group">
                            {{ form.brutality_max.label(class="form-control-label") }}

                            {% if form.brutality_max.errors %}
                                {{ form.brutality_max(class="form-control form-control-sm is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for error in form.brutality_max.errors %}
                                        <span>{{ error }}</span>
                                    {% endfor %}
                                </div>
                            {% else %}
                                {{ form.brutality_max(class="form-control form-control-sm") }}
                            {% endif %}
                        </div>
                        <div class="form-group">
                            {{ form.quietness_min.label(class="form-control-label") }}

                            {% if form.quietness_min.errors %}
                                {{ form.quietness_min(class="form-control form-control-sm is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for error in form.quietness_min.errors %}
                                        <span>{{ error }}</span>
                                    {% endfor %}
                                </div>
                            {% else %}
                                {{ form.quietness_min(class="form-control form-control-sm") }}
                            {% endif %}
                        </div>
                        <div class="form-group">
                            {{ form.quietness_max.label(class="form-control-label") }}

                            {% if form.quietness_max.errors %}
                                {{ form.quietness_max(class="form-control form-control-sm is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for error in form.quietness_max.errors %}
                                        <span>{{ error }}</span>
                                    {% endfor %}
                                </div>
                            {% else %}
                                {{ form.quietness_max(class="form-control form-control-sm") }}
                            {% endif %}
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            {{ form.sort_by.label(class="form-control-label") }}

                            {% if form.sort_by.errors %}
                                {{ form.sort_by(class="form-control form-control-sm is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for error in form.sort_by.errors %}
                                        <span>{{ error }}</span>
                                    {% endfor %}
                                </div>
                            {% else %}
                                {{ form.sort_by(class="form-control form-control-sm") }}
                            {% endif %}
                        </div>
                    </div>
                </div>
                    </fieldset>
                        <div class="form-group">
                            {{form.submit(class="btn btn-primary btn-sm")}}
                        </div>
                </form>
                </div>
        </div>
        <div class="col-md-12">
            <table class="table">
                <thead>
                    <tr>
                        <th scope="col">Title</th>
                        <th scope="col">Region</th>
                        <th scope="col">Start</th>
                        <th scope="col">Length</th>
                        <th scope="col">Ascent</th>
                        <th scope="col">Scenery</th>
                        <th scope="col">Brutality</th>
                        <th scope="col">Quietness</th>
                    </tr>
                </thead>
                <tbody>
                {% for route in my_routes.items %}
                    <tr>
                        <th scope="row"><a href="{{ url_for('posts.postPage', post_id=route.post) }}" class="custom-link">{{ route.title }}</a></th>
                        <td>{{ route.region }}</td>
                        <td>{{ route.starting_location }}</td>
                        <td>{{ route.length }} km</td>
                        <td>{{ route.ascent }} m</td>
                        <td><img src="{{ url_for('static', filename='/icons/' + route.scenery|string + '.png') }}" class="rating-stars" title="{{ route.scenery }}/10"></td>
                        <td><img src="{{ url_for('static', filename='/icons/' + route.brutality|string + '.png') }}" class="rating-stars" title="{{ route.brutality }}/10"></td>
                        <td><img src="{{ url_for('static', filename='/icons/' + route.quietness|string + '.png') }}" class="rating-stars" title="{{ route.quietness }}/10"></td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    <div class="d-flex justify-content-center p-3">
        <nav aria-label="Page navigation example">
            <ul class="pagination">
                <li class="page-item {% if not my_routes.has_prev %}disabled{% endif %}"><a class="page-link" href="{{ url_for('routes.routesPage', page=1) }}">First</a></li>
                <li class="page-item {% if not my_routes.has_prev %}disabled{% endif %}"><a class="page-link" href="{{ url_for('routes.routesPage', page=my_routes.prev_num) }}">Previous</a></li>
                {% for page_num in my_routes.iter_pages() %}
                {% if page_num %}
                <li class="page-item {% if my_routes.page == page_num %}active{% endif %}"><a class="page-link" href="{{ url_for('routes.routesPage', page=page_num) }}">{{ page_num }}</a></li>
                {% endif %}
                {% endfor %}
                <li class="page-item {% if not my_routes.has_next %}disabled{% endif %}"><a class="page-link" href="{{ url_for('routes.routesPage', page=my_routes.next_num) }}">Next</a></li>
            </ul>
        </nav>
    </div>
{% endblock content %}